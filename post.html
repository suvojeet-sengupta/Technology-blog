<!DOCTYPE html>
<html lang="hi" class="">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>टेक ज्ञान</title> <!-- Title will be updated by JS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Noto+Sans+Devanagari:wght@400;500;700&display=swap" rel="stylesheet">
    <script>
        if (localStorage.getItem('color-theme') === 'dark' || (!('color-theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.documentElement.classList.add('dark');
        } else {
            document.documentElement.classList.remove('dark');
        }
    </script>
    <style>
        body { font-family: 'Inter', 'Noto Sans Devanagari', sans-serif; }
        .markdown-content h1, .markdown-content h2, .markdown-content h3 {
            margin-top: 2em; margin-bottom: 1em; line-height: 1.3; font-weight: 700;
        }
        .markdown-content h1 { font-size: 2.5rem; }
        .markdown-content h2 { font-size: 2rem; border-bottom: 1px solid #e2e8f0; padding-bottom: 0.3em; }
        .markdown-content h3 { font-size: 1.5rem; }
        .markdown-content p { margin-bottom: 1.25em; line-height: 1.8; font-size: 1.125rem; }
        .markdown-content code { background-color: #e2e8f0; color: #1e293b; padding: 0.2em 0.4em; border-radius: 3px; font-size: 0.9em; }
        .dark .markdown-content code { background-color: #334155; color: #e2e8f0; }
        .dark .markdown-content h2 { border-color: #334155; }
    </style>
</head>
<body class="bg-slate-50 dark:bg-slate-900 text-slate-800 dark:text-slate-200 transition-colors duration-300">

    <!-- Header (Same as index.html) -->
    <header class="bg-white/80 dark:bg-slate-900/80 backdrop-blur-lg shadow-sm sticky top-0 z-20">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-4 flex justify-between items-center">
            <a href="/" class="text-2xl md:text-3xl font-bold bg-gradient-to-r from-blue-500 to-violet-500 bg-clip-text text-transparent">
                टेक ज्ञान
            </a>
            <div class="flex items-center space-x-4">
                <button id="theme-toggle" type="button" class="text-slate-500 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-700 focus:outline-none rounded-lg text-sm p-2.5">
                    <svg id="theme-toggle-dark-icon" class="hidden w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path></svg>
                    <svg id="theme-toggle-light-icon" class="hidden w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 5.05A1 1 0 003.636 6.464l.707.707a1 1 0 001.414-1.414l-.707-.707zM3 11a1 1 0 100-2H2a1 1 0 100 2h1zm7.536 2.464a1 1 0 01-1.414 0l-.707-.707a1 1 0 011.414-1.414l.707.707a1 1 0 010 1.414zM13.536 6.464a1 1 0 01-1.414 0l-.707-.707a1 1 0 011.414-1.414l.707.707a1 1 0 010 1.414z"></path></svg>
                </button>
            </div>
        </div>
    </header>

    <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12">
        <article id="post-content" class="max-w-4xl mx-auto bg-white dark:bg-slate-800 p-6 sm:p-8 md:p-12 rounded-2xl shadow-lg">
            <!-- Post content will be injected here -->
            <div class="text-center py-20">
                <p>Loading post...</p>
            </div>
        </article>
    </main>

    <script>
        // --- Dark Mode Toggle Logic (same as index.html) ---
        const themeToggleDarkIcon = document.getElementById('theme-toggle-dark-icon');
        const themeToggleLightIcon = document.getElementById('theme-toggle-light-icon');
        if (localStorage.getItem('color-theme') === 'dark' || (!('color-theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            themeToggleLightIcon.classList.remove('hidden');
        } else {
            themeToggleDarkIcon.classList.remove('hidden');
        }
        document.getElementById('theme-toggle').addEventListener('click', function() { /* ... same as index.html ... */ });


        // --- Post Loading Logic ---
        async function loadPost() {
            const params = new URLSearchParams(window.location.search);
            const slug = params.get('slug');
            const articleContainer = document.getElementById('post-content');

            if (!slug) {
                articleContainer.innerHTML = `<h1 class="text-center text-red-500">Post not found!</h1>`;
                return;
            }

            try {
                const blogsResponse = await fetch(`blogs.json?v=${new Date().getTime()}`);
                const blogs = await blogsResponse.json();
                const post = blogs.find(p => p.slug === slug);

                if (!post) throw new Error('Post not found in JSON');

                const markdownResponse = await fetch(post.post_path);
                const markdown = await markdownResponse.text();
                
                document.title = `${post.title} - टेक ज्ञान`;

                let html = markdown
                    .replace(/^# (.*$)/gim, '') // Title is already displayed, so remove it from content
                    .replace(/^## (.*$)/gim, '<h2>$1</h2>')
                    .replace(/^### (.*$)/gim, '<h3>$1</h3>')
                    .replace(/\*\*(.*)\*\*/g, '<strong>$1</strong>')
                    .replace(/\*(.*)\*/g, '<em>$1</em>')
                    .replace(/`([^`]+)`/g, '<code>$1</code>')
                    .replace(/\n/g, '<br>');

                const postURL = window.location.href;
                
                articleContainer.innerHTML = `
                    <header class="text-center mb-12">
                        <h1 class="text-3xl md:text-5xl font-extrabold text-slate-900 dark:text-white">${post.title}</h1>
                        <div class="mt-6 text-slate-500 dark:text-slate-400 flex items-center justify-center space-x-4">
                            <span>${post.date}</span>
                            <span>&bull;</span>
                            <span>${post.read_time} min read</span>
                            <span>&bull;</span>
                            <span>By Suvojeet Sengupta</span>
                        </div>
                    </header>
                    <div class="markdown-content">${html}</div>
                    <footer class="mt-12 pt-8 border-t border-slate-200 dark:border-slate-700">
                        <h3 class="text-lg font-bold text-center mb-4">इस पोस्ट को शेयर करें</h3>
                        <div class="flex justify-center items-center space-x-4">
                            <a href="https://api.whatsapp.com/send?text=${encodeURIComponent(post.title + ' ' + postURL)}" target="_blank" class="bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600 transition-colors">WhatsApp</a>
                            <a href="https://twitter.com/intent/tweet?text=${encodeURIComponent(post.title)}&url=${postURL}" target="_blank" class="bg-sky-500 text-white px-4 py-2 rounded-lg hover:bg-sky-600 transition-colors">Twitter</a>
                            <a href="https://www.linkedin.com/shareArticle?mini=true&url=${postURL}&title=${encodeURIComponent(post.title)}" target="_blank" class="bg-blue-700 text-white px-4 py-2 rounded-lg hover:bg-blue-800 transition-colors">LinkedIn</a>
                        </div>
                    </footer>
                `;

            } catch (error) {
                console.error("Failed to load post:", error);
                articleContainer.innerHTML = `<h1 class="text-center text-red-500">Error: ${error.message}</h1>`;
            }
        }
        
        window.onload = loadPost;
    </script>
</body>
</html>

